# Leash default configuration
monitor_interval_ms: 1000

# AI tool process identifiers to watch
ai_agents:
  - claude
  - claude_code
  - codex
  - cursor
  - gpt
  - aider
  - cline
  - node

# Legitimate parents for AI agents. If an AI agent is spawned by anything else,
# sensitive-file access is elevated.
legitimate_ai_parents:
  - node
  - npm
  - bash
  - zsh
  - sh
  - tmux
  - screen
  - systemd

# Sensitive access keywords used against open file paths in /proc/<pid>/fd
sensitive_path_keywords:
  - .ssh
  - .gnupg
  - vault
  - secret
  - token
  - credential
  - .env
  - shadow
  - sudoers

# File integrity monitor roots
fim_paths:
  - ~/.ssh
  - ~/.config
  - ~/.claude
  - ~/.codex
  - /etc/passwd
  - /etc/shadow
  - /etc/sudoers

# Processes never frozen by response engine
protected_processes:
  - systemd
  - sshd
  - NetworkManager
  - claude
  - codex
  - leash

response:
  # Explicit opt-in
  enable_sigstop: false
  stop_min_level: orange

alerts:
  min_severity: orange
  rate_limit_seconds: 300
  learning_mode_hours: 24
  deduplication_enabled: false
  deduplication_window_seconds: 300
  slack:
    enabled: false
    webhook_url: ""
  discord:
    enabled: false
    webhook_url: ""
  telegram:
    enabled: false
    bot_token: ""
    chat_id: ""
  json_log:
    enabled: true
    path: ~/.local/state/leash/alerts.jsonl

egress:
  suspicious_ports:
    - 4444
    - 4445
    - 5555
    - 6666
    - 7777
    - 8888
    - 9999
    - 1337
    - 31337
  tor_ports:
    - 9000
    - 9001
    - 9002
    - 9003
    - 9004
    - 9005
    - 9006
    - 9007
    - 9008
    - 9009
    - 9010
    - 9011
    - 9012
    - 9013
    - 9014
    - 9015
    - 9016
    - 9017
    - 9018
    - 9019
    - 9020
    - 9021
    - 9022
    - 9023
    - 9024
    - 9025
    - 9026
    - 9027
    - 9028
    - 9029
    - 9030
    - 9031
    - 9032
    - 9033
    - 9034
    - 9035
    - 9036
    - 9037
    - 9038
    - 9039
    - 9040
    - 9041
    - 9042
    - 9043
    - 9044
    - 9045
    - 9046
    - 9047
    - 9048
    - 9049
    - 9050
    - 9051
    - 9052
    - 9053
  exfil_domains:
    - pastebin
    - transfer.sh
    - file.io
  suspicious_country_ip_prefixes: []

datasets:
  enabled: true
  cache_dir: ~/.config/leash/datasets
  auto_update: true
  update_interval_days: 7
  lolrmm_url: https://lolrmm.io/api/rmm_tools.json
  loldrivers_url: https://www.loldrivers.io/api/drivers.json
