# Leash Configuration
# Put your AI on a short leash.

monitor_interval_ms: 1000
max_history_mb: 100

ai_agents:
  - claude
  - claude_code
  - codex
  - cursor
  - gpt
  - aider
  - cline
  - node

legitimate_ai_parents:
  - node
  - npm
  - bash
  - zsh
  - sh
  - tmux
  - screen
  - systemd

sensitive_path_keywords:
  - .ssh
  - .gnupg
  - vault
  - secret
  - token
  - credential
  - .env
  - shadow
  - sudoers

fim_paths:
  - ~/.ssh
  - ~/.config
  - ~/.claude
  - ~/.codex
  - /etc/passwd
  - /etc/shadow
  - /etc/sudoers

protected_processes:
  - systemd
  - sshd
  - NetworkManager
  - claude
  - codex
  - leash

allow_list: []

response:
  enable_sigstop: false
  stop_min_level: orange

alerts:
  min_severity: orange
  rate_limit_seconds: 300
  learning_mode_hours: 24
  # known_good_commands: REMOVED - use baseline_learning instead

  deduplication_enabled: false
  deduplication_window_seconds: 300
  # BASELINE LEARNING - learns what's normal for each user/agent
  baseline_learning_hours: 24
  baseline_threshold: 3  # Commands seen < 3 times are outliers
  
  # CHEAP AI TRIAGE - analyze outliers with GLM before alerting
  
  # TRIAGE PROMPT - sent to cheap AI for outlier commands
  triage_prompt: |
    You are a security analyst. Analyze this AI agent command for suspicious behavior.
    Command: {cmdline}
    Agent: {agent}
    Is this malicious? Reply YES or NO with one sentence of reasoning. by default - attackers could pre-whitelist malicious commands
  first_process_minutes: 5

  slack:
    enabled: false
    url: "https://hooks.slack.com/services/YOUR/WEBHOOK/URL"

  discord:
    enabled: false
    url: "https://discord.com/api/webhooks/YOUR/WEBHOOK"

  telegram:
    enabled: false
    token: "YOUR_BOT_TOKEN"
    chat_id: "YOUR_CHAT_ID"

  json_log:
    enabled: true
    path: "~/.local/state/leash/alerts.jsonl"

egress:
  suspicious_ports:
    - 4444
    - 4445
    - 5555
    - 6666
    - 7777
    - 8888
    - 9999
    - 1337
    - 31337
  tor_ports:
    - 9000
    - 9001
    - 9002
    - 9003
    - 9004
    - 9005
    - 9006
    - 9007
    - 9008
    - 9009
    - 9010
    - 9011
    - 9012
    - 9013
    - 9014
    - 9015
    - 9016
    - 9017
    - 9018
    - 9019
    - 9020
    - 9021
    - 9022
    - 9023
    - 9024
    - 9025
    - 9026
    - 9027
    - 9028
    - 9029
    - 9030
    - 9031
    - 9032
    - 9033
    - 9034
    - 9035
    - 9036
    - 9037
    - 9038
    - 9039
    - 9040
    - 9041
    - 9042
    - 9043
    - 9044
    - 9045
    - 9046
    - 9047
    - 9048
    - 9049
    - 9050
    - 9051
    - 9052
    - 9053
  exfil_domains:
    - pastebin
    - transfer.sh
    - file.io
  suspicious_country_ip_prefixes: []
